class DocumentsController < ApplicationController
  before_action :set_edifici
  layout 'edifici'

  def index
    @submenu_actiu = 'documents'
  end

  def quadern
    @menu_documents_actiu = 'quadern'
  end

  def nou_plurifamiliar
    respond_to do |format|
      format.docx do
        doc = DocxReplace::Doc.new("#{Rails.root}/lib/docx_templates/nou_plurifamiliar5.docx", "#{Rails.root}/tmp")
        # Adreça de l'edifici
        adreca = @edifici.identificacio.tipus_via_edifici.to_s + ' ' + @edifici.identificacio.via_edifici.to_s + ' ' + @edifici.identificacio.numero_edifici.to_s + ' ' + @edifici.identificacio.bloc_edifici.to_s
        doc.replace("$adreca$", adreca)
        doc.replace("$adreca_edifici$", adreca)
        doc.replace("$codi_postal$", @edifici.identificacio.cp_edifici)
        doc.replace("$codi_postal_edifici$", @edifici.identificacio.cp_edifici)
        doc.replace("$poblacio$", @edifici.identificacio.poblacio_edifici)
        doc.replace("$poblacio_edifici$", @edifici.identificacio.poblacio_edifici)
        doc.replace("$provincia$", @edifici.identificacio.provincia_edifici)
        doc.replace("$provincia_edifici$", @edifici.identificacio.provincia_edifici)
        doc.replace("$referencia_cadastral$", @edifici.identificacio.ref_cadastral)
        doc.replace("$us_edifici$", @edifici.identificacio.us_edifici)
        doc.replace("$any_inici_construccio$", @edifici.identificacio.any_inici_construccio)
        doc.replace("$any_fi_construccio$", @edifici.identificacio.any_fi_construccio)
        
        # Promotor
        word_promotor = ''
        if @edifici.promotors.count > 0
          @edifici.promotors.each do |promotor|
            word_promotor = word_promotor + '<w:p w14:paraId="4A63F336" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00EC1F1B"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r w:rsidRPr="00EC1F1B"><w:rPr><w:b/></w:rPr><w:t>Promotor</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.nom_promotor + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF/CIF:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.nif_promotor + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="61432898" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="8638" w:type="dxa"/><w:gridSpan w:val="2"/></w:tcPr><w:p w14:paraId="5ACA8A64" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Adreça:</w:t></w:r></w:p><w:p w14:paraId="272C158A" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.adreca_promotor + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Codi postal:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.cp_promotor + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Població:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.poblacio_promotor + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="0FF076AE" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0AA197CB" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Província:</w:t></w:r></w:p><w:p w14:paraId="74490037" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.provincia_promotor + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="2F9A2409" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>País:</w:t></w:r></w:p><w:p w14:paraId="47653008" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + promotor.pais_promotor + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"/><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$promotor$", word_promotor)
        
        # Projectista
        word_projectista = ''
        if @edifici.projectistes.count > 0
          @edifici.projectistes.each do |projectista|
            word_projectista = word_projectista + '<w:p w14:paraId="4A63F336" w14:textId="69799D5E" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00B4194E"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r><w:rPr><w:b/></w:rPr><w:t>Projectista</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="23E30075" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + projectista.nom_projectista + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="325A66C5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="36199EA2" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + projectista.nif_projectista + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="38673767" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Titulació</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="2C0C52D5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + projectista.titulacio_projectista + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="29EE1FC5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Raó social:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="1B1B7C7C" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + projectista.rao_social_projectista + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"><w:bookmarkStart w:id="0" w:name="_GoBack"/><w:bookmarkEnd w:id="0"/></w:p><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$projectista$", word_projectista)
        
        # Constructor
        word_constructor = ''
        if @edifici.constructors.count > 0
          @edifici.constructors.each do |constructor|
            word_constructor = word_constructor + '<w:p w14:paraId="4A63F336" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00EC1F1B"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r w:rsidRPr="00EC1F1B"><w:rPr><w:b/></w:rPr><w:t>Constructor</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.nom_constructor + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF/CIF:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.nif_constructor + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="61432898" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="8638" w:type="dxa"/><w:gridSpan w:val="2"/></w:tcPr><w:p w14:paraId="5ACA8A64" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Adreça:</w:t></w:r></w:p><w:p w14:paraId="272C158A" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.adreca_constructor + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Codi postal:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.cp_constructor + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Població:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.poblacio_constructor + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="0FF076AE" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0AA197CB" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Província:</w:t></w:r></w:p><w:p w14:paraId="74490037" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.provincia_constructor + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="2F9A2409" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>País:</w:t></w:r></w:p><w:p w14:paraId="47653008" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + constructor.pais_constructor + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"/><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$constructor$", word_constructor)

        # Director d'obra
        word_director = ''
        if @edifici.directors.count > 0
          @edifici.directors.each do |director|
            word_director = word_director + '<w:p w14:paraId="4A63F336" w14:textId="69799D5E" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00B4194E"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r><w:rPr><w:b/></w:rPr><w:t>Director d\'obra</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="23E30075" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director.nom_director + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="325A66C5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="36199EA2" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director.nif_director + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="38673767" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Titulació</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="2C0C52D5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director.titulacio_director + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="29EE1FC5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Raó social:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="1B1B7C7C" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director.rao_social_director + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"><w:bookmarkStart w:id="0" w:name="_GoBack"/><w:bookmarkEnd w:id="0"/></w:p><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$director_obra$", word_director)

        # Director d'execució d'obra
        word_director_execucio = ''
        if @edifici.execucio_directors.count > 0
          @edifici.execucio_directors.each do |director_execucio|
            word_director_execucio = word_director_execucio + '<w:p w14:paraId="4A63F336" w14:textId="69799D5E" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00B4194E"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r><w:rPr><w:b/></w:rPr><w:t>Director d\'execució d\'obra</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="23E30075" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director_execucio.nom_director_execucio + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="325A66C5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="36199EA2" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director_execucio.nif_director_execucio + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="38673767" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Titulació</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="2C0C52D5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director_execucio.titulacio_director_execucio + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="29EE1FC5" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Raó social:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="1B1B7C7C" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + director_execucio.rao_social_director_execucio + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"><w:bookmarkStart w:id="0" w:name="_GoBack"/><w:bookmarkEnd w:id="0"/></w:p><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$director_execucio$", word_director_execucio)

        # Laboratoris
        word_laboratoris = ''
        if @edifici.laboratoris.count > 0
          @edifici.laboratoris.each do |laboratori|
            word_laboratoris = word_laboratoris + '<w:p w14:paraId="4A63F336" w14:textId="69799D5E" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E" w:rsidRPr="00477B92"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r><w:rPr><w:b/></w:rPr><w:t>Laboratori</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:type="auto" w:w="0"/><w:tblBorders><w:top w:color="auto" w:space="0" w:sz="0" w:val="none"/><w:left w:color="auto" w:space="0" w:sz="0" w:val="none"/><w:right w:color="auto" w:space="0" w:sz="0" w:val="none"/><w:insideV w:color="auto" w:space="0" w:sz="0" w:val="none"/></w:tblBorders><w:tblLook w:firstColumn="1" w:firstRow="1" w:lastColumn="0" w:lastRow="0" w:noHBand="0" w:noVBand="1" w:val="04A0"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w14:paraId="75F533A0" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:type="dxa" w:w="4319"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidP="00477B92" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="23E30075" w:rsidP="00477B92" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + laboratori.nom_laboratori + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:type="dxa" w:w="4319"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="325A66C5" w:rsidP="00477B92" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF</w:t></w:r><w:r w:rsidR="00EC1F1B"><w:t>:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="36199EA2" w:rsidP="00477B92" w:rsidR="00EC1F1B" w:rsidRDefault="00B4194E"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + laboratori.nif_laboratori + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"><w:bookmarkStart w:id="0" w:name="_GoBack"/><w:bookmarkEnd w:id="0"/></w:p><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:h="16840" w:w="11900"/><w:pgMar w:bottom="1417" w:footer="708" w:gutter="0" w:header="708" w:left="1701" w:right="1701" w:top="1417"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$laboratori$", word_laboratoris)

        # Entitats de control
        word_entitats = ''
        if @edifici.entitat_controls.count > 0
          @edifici.entitat_controls.each do |entitat|
            word_entitats = word_entitats + '<w:p w14:paraId="4A63F336" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00EC1F1B"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r w:rsidRPr="00EC1F1B"><w:rPr><w:b/></w:rPr><w:t>Entitat de control</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.nom_entitat_control + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF/CIF:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.nif_entitat_control + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="61432898" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="8638" w:type="dxa"/><w:gridSpan w:val="2"/></w:tcPr><w:p w14:paraId="5ACA8A64" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Adreça:</w:t></w:r></w:p><w:p w14:paraId="272C158A" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.adreca_entitat_control + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Codi postal:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.cp_entitat_control + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Població:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.poblacio_entitat_control + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="0FF076AE" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0AA197CB" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Província:</w:t></w:r></w:p><w:p w14:paraId="74490037" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.provincia_entitat_control + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="2F9A2409" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>País:</w:t></w:r></w:p><w:p w14:paraId="47653008" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + entitat.pais_entitat_control + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"/><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$entitat_control$", word_entitats)

        # Subministradors de productes
        word_subministrador = ''
        if @edifici.subministradors.count > 0
          @edifici.subministradors.each do |subministrador|
            word_subministrador = word_subministrador + '<w:p w14:paraId="4A63F336" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00EC1F1B"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r w:rsidRPr="00EC1F1B"><w:rPr><w:b/></w:rPr><w:t>Subministrador de productes</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.nom_subministrador + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF/CIF:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.nif_subministrador + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="61432898" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="8638" w:type="dxa"/><w:gridSpan w:val="2"/></w:tcPr><w:p w14:paraId="5ACA8A64" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Adreça:</w:t></w:r></w:p><w:p w14:paraId="272C158A" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.adreca_subministrador + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Codi postal:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.cp_subministrador + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Població:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.poblacio_subministrador + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="0FF076AE" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0AA197CB" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Província:</w:t></w:r></w:p><w:p w14:paraId="74490037" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.provincia_subministrador + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="2F9A2409" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>País:</w:t></w:r></w:p><w:p w14:paraId="47653008" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + subministrador.pais_subministrador + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"/><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$subministrador$", word_subministrador)

        # Industrials
        word_industrial = ''
        if @edifici.industrials.count > 0
          @edifici.industrials.each do |industrial|
            word_industrial = word_industrial + '<w:p w14:paraId="4A63F336" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRPr="00477B92" w:rsidRDefault="00EC1F1B"><w:pPr><w:rPr><w:b/></w:rPr></w:pPr><w:r w:rsidRPr="00EC1F1B"><w:rPr><w:b/></w:rPr><w:t>Industrial</w:t></w:r></w:p><w:tbl><w:tblPr><w:tblStyle w:val="Tablaconcuadrcula"/><w:tblW w:w="0" w:type="auto"/><w:tblBorders><w:top w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:left w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:right w:val="none" w:sz="0" w:space="0" w:color="auto"/><w:insideV w:val="none" w:sz="0" w:space="0" w:color="auto"/></w:tblBorders><w:tblLook w:val="04A0" w:firstRow="1" w:lastRow="0" w:firstColumn="1" w:lastColumn="0" w:noHBand="0" w:noVBand="1"/></w:tblPr><w:tblGrid><w:gridCol w:w="4319"/><w:gridCol w:w="4319"/></w:tblGrid><w:tr w:rsidR="00EC1F1B" w14:paraId="75F533A0" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="77762A24" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Nom:</w:t></w:r></w:p><w:p w14:paraId="0B3BAAE1" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.nom_industrial + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0B1740B3" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>NIF/CIF:</w:t></w:r></w:p><w:p w14:paraId="1619C708" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.nif_industrial + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="61432898" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="8638" w:type="dxa"/><w:gridSpan w:val="2"/></w:tcPr><w:p w14:paraId="5ACA8A64" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Adreça:</w:t></w:r></w:p><w:p w14:paraId="272C158A" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.adreca_industrial + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="62DE70FD" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="68794AC6" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Codi postal:</w:t></w:r></w:p><w:p w14:paraId="10367BED" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.cp_industrial + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="153CFF74" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Població:</w:t></w:r></w:p><w:p w14:paraId="6020BC23" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.poblacio_industrial + '</w:t></w:r></w:p></w:tc></w:tr><w:tr w:rsidR="00EC1F1B" w14:paraId="0FF076AE" w14:textId="77777777" w:rsidTr="00477B92"><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="0AA197CB" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>Província:</w:t></w:r></w:p><w:p w14:paraId="74490037" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.provincia_industrial + '</w:t></w:r></w:p></w:tc><w:tc><w:tcPr><w:tcW w:w="4319" w:type="dxa"/></w:tcPr><w:p w14:paraId="2F9A2409" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="titoltaula"/></w:pPr><w:r><w:t>País:</w:t></w:r></w:p><w:p w14:paraId="47653008" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B" w:rsidP="00477B92"><w:pPr><w:pStyle w:val="normaltaula"/></w:pPr><w:r><w:t>' + industrial.pais_industrial + '</w:t></w:r></w:p></w:tc></w:tr></w:tbl><w:p w14:paraId="1705A789" w14:textId="77777777" w:rsidR="00EC1F1B" w:rsidRDefault="00EC1F1B"/><w:sectPr w:rsidR="00EC1F1B" w:rsidSect="00B66F90"><w:pgSz w:w="11900" w:h="16840"/><w:pgMar w:top="1417" w:right="1701" w:bottom="1417" w:left="1701" w:header="708" w:footer="708" w:gutter="0"/><w:cols w:space="708"/><w:docGrid w:linePitch="360"/></w:sectPr>'
          end
        end
        doc.replace("$industrial$", word_industrial)

        # Descripció constructiva
        # Fonamentació
        word_fonamentacio = ''
        if @edifici.fonamentacio.mur_pedra == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Mur de contenció de pedra</w:t></w:r></w:p>'
        end
        if @edifici.fonamentacio.mur_fabrica_mao == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Mur de contenció de fàbrica de maó</w:t></w:r></w:p>'
        end
        if @edifici.fonamentacio.mur_fabrica_bloc == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Mur de contenció de fàbrica de bloc</w:t></w:r></w:p>'
        end
        if @edifici.fonamentacio.mur_formigo_armat == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Mur de contenció de formigó armat</w:t></w:r></w:p>'
        end 
        if @edifici.fonamentacio.mur_pantalla == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Mur de contenció de pantalla de formigó armat</w:t></w:r></w:p>'
        end 
        if @edifici.fonamentacio.sabates_paredat == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Sabates de paredat</w:t></w:r></w:p>'
        end 
        if @edifici.fonamentacio.sabates_formigo == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Sabates o rases de formigó</w:t></w:r></w:p>'
        end 
        if @edifici.fonamentacio.llosa == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Llosa de formigó</w:t></w:r></w:p>'
        end 
        if @edifici.fonamentacio.pilons == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Fonamentació profunda de pilons</w:t></w:r></w:p>'
        end 
        if @edifici.fonamentacio.pantalles == true
          word_fonamentacio = word_fonamentacio + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Fonamentació profunda de pantalles</w:t></w:r></w:p>'
        end 
        doc.replace("$fonamentacio$", word_fonamentacio)

        # Estructura
        word_estructura = ''
        if @edifici.estructura.parets_pedra == true
          word_estructura = word_estructura + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Parets de paredat</w:t></w:r></w:p>'
        end
        if @edifici.estructura.parets_formigo_armat == true
          word_estructura = word_estructura + '<w:p w:rsidP="006E3F51" w:rsidR="00676FB5" w:rsidRDefault="006E3F51"><w:pPr><w:pStyle w:val="Prrafodelista"/><w:numPr><w:ilvl w:val="0"/><w:numId w:val="1"/></w:numPr></w:pPr><w:r><w:t>Parets de formigó armat</w:t></w:r></w:p>'
        end
        doc.replace("$estructura$", word_estructura)
          



        tmp_file = Tempfile.new('word_tempate', "#{Rails.root}/tmp")
        doc.commit(tmp_file.path)

        send_file tmp_file.path, filename: "#{@edifici.nom_edifici}.docx", disposition: 'attachment'
      end
    end
  end

  def document_quadern
    @operacions = Operacio.all
    @text_operacions = ''
    @operacions.each do |operacio|
      @text_operacions = @text_operacions.to_s + '<w:p><w:r><w:t>' + operacio.descripcio_ca.to_s + '</w:t></w:r></w:p><w:p/>' 
    end
    respond_to do |format|
      format.docx do
        # Initialize DocxReplace with your template
        doc = DocxReplace::Doc.new("#{Rails.root}/lib/docx_templates/quadern_template.docx", "#{Rails.root}/tmp")

        # Replace some variables. $var$ convention is used here, but not required.
        doc.replace("$nom_edifici$", @edifici.nom_edifici)
        doc.replace("$operacions$", @text_operacions)
        #doc.replace("$altres_operacions$", )

        # Write the document back to a temporary file
        tmp_file = Tempfile.new('word_tempate', "#{Rails.root}/tmp")
        doc.commit(tmp_file.path)

        # Respond to the request by sending the temp file
        send_file tmp_file.path, filename: "edifici_#{@edifici.nom_edifici}_quadern.docx", disposition: 'attachment'
      end
    end
  end

  def det
  end

  def manual
  end

  def arxiu
  end

  private

    def set_edifici
      @edifici = Edifici.find(params[:edifici_id])
    end
end
